# ScriptNote - Obsidian 短剧剧本写作插件

ScriptNote 是一款专为短剧剧本创作设计的 Obsidian 插件，提供智能场景编号、格式化导出、实时统计等功能，让剧本写作更加高效流畅。

## ✨ 功能特性

### 📝 智能写作辅助

- **场景自动编号**：自动生成 `X-X` 格式的场景编号（集-场）
- **场景头格式**：标准格式 `X-X 日/夜 内/外 地点` + 人物行
- **闪回支持**：一键插入闪回标记（含开始和结束）
- **动作描述**：快速插入 △ 符号标记动作描述
- **智能回车**：按回车后自动插入 △ 动作描述符号（可在设置中开关）
- **旁白/独白**：支持 OS（旁白）、VO（内心独白）格式

### 🎯 人物快速输入（v1.1.0 新增）

- **@ 人物选择**：输入 `@` 触发人物选择弹窗
  - 支持模糊搜索过滤（如 `@李` 只显示包含"李"的人物）
  - 人物自动从文档的 `人物：` 行提取
  - 选择后自动添加冒号 `：`
  
- **台词修饰符选择**：输入人物名后按快捷键弹出修饰符选择
  - 默认快捷键：`Option+Tab`（Mac）/ `Alt+Tab`（Windows）
  - 可在设置中自定义快捷键组合（Alt/Ctrl/Shift + 任意按键）
  - 支持选项：`：`（直接台词）、`（OS）：`、`（VO）：`、自定义情绪
  - 如果光标在冒号后，会替换冒号为选择的修饰符

**完整写作流程示例：**
```
方式一：@ 选人物（自动加冒号）
1. 输入 @ → 选择"李明" → 插入"李明："
2. 直接输入台词内容

方式二：@ 选人物 + 修饰符
1. 输入 @ → 选择"李明" → 插入"李明："
2. 按 Option+Tab → 选择"（OS）：" → 变成"李明（OS）："
3. 输入台词内容
```

### 📊 实时统计

- **字数统计**：总字数及每集字数统计
- **人物统计**：角色台词数量、出场集数
- **出场详情**：点击展开查看角色每句台词，支持跳转定位

### 📤 Word 导出

- **格式化导出**：保留场景头、台词、动作描述等格式
- **自定义格式**：可在设置中自定义字体、字号
  - 集标题：默认黑体 16pt 居中加粗
  - 场景头：默认黑体 12pt 加粗
  - 正文/台词：默认宋体 12pt
  - 角色名：默认宋体 12pt 加粗
  - 动作描述：默认楷体 12pt

### 🎬 项目管理

- **多项目支持**：可管理多个剧本项目
- **剧本标识**：通过 `type: screenplay` frontmatter 标记剧本文件
- **场景头验证**：实时高亮显示格式错误的场景头

## 📦 安装

### 手动安装

1. 下载最新版本的 `main.js`、`manifest.json` 和 `styles.css`
2. 在 Obsidian 库的 `.obsidian/plugins/` 目录下创建 `scriptnote` 文件夹
3. 将下载的文件复制到该文件夹
4. 重启 Obsidian 并在设置中启用插件

## 🚀 快速开始

### 1. 创建剧本项目

1. 打开任意 Markdown 文件
2. 点击右侧边栏的 ScriptNote 图标（🎬）
3. 点击「创建剧本项目」将当前文件夹设为剧本项目
4. 点击「标记为剧本」为当前文件添加剧本标签

### 2. 开始写作

剧本文件需要包含以下 frontmatter：

```yaml
---
type: screenplay
---
```

### 3. 使用快速插入

在侧边面板的「快速插入」区域：

- **插入场景**：插入新场景头，光标自动定位到「地点」便于修改
- **新建一集**：插入新一集标题和首个场景
- **△ 动作描述**：插入动作描述符号
- **插入闪回**：插入完整闪回（含开始和结束标记）

### 4. 剧本格式示例

```markdown
---
type: screenplay
---

# 第一集

1-1 日 内 李明家·客厅
人物：李明、王芳

△ 阳光透过窗帘洒进房间。

李明：（疑惑）你怎么来了？
王芳：我有事找你。

【闪回】

1-2 夜 外 街道
人物：李明

△ 雨夜，李明独自走在街上。

【闪回结束】

1-3 日 内 李明家·客厅
人物：李明、王芳

李明（OS）：那天晚上的事，我永远忘不了。
王芳（VO）：他到底在想什么...
```

## ⌨️ 快捷键

可在 Obsidian 设置 → 快捷键 中自定义：

| 功能 | 命令 ID |
|------|---------|
| 插入场景 | `scriptnote:insert-scene` |
| 新建一集 | `scriptnote:new-episode` |
| 插入闪回 | `scriptnote:insert-flashback` |
| 结束闪回 | `scriptnote:end-flashback` |
| 插入动作描述 | `scriptnote:insert-action` |
| 插入旁白（OS） | `scriptnote:insert-os` |
| 插入内心独白（VO） | `scriptnote:insert-vo` |

## ⚙️ 设置选项

### 功能开关

- **启用角色选择弹窗**：输入 `/` 时显示角色选择列表

### 导出格式

可自定义 Word 导出的字体和字号：

- 集标题格式（字体、字号、加粗、居中）
- 场景头格式（字体、字号、加粗）
- 正文格式（字体、字号）
- 角色名格式（字体、字号、加粗）
- 动作描述格式（字体、字号）

## 🛠️ 开发

```bash
# 安装依赖
npm install

# 开发模式
npm run dev

# 构建
npm run build
```

## 📄 许可证

MIT License

## 🤝 贡献

欢迎提交 Issue 和 Pull Request！
